<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns:fb="sap.ui.comp.filterbar" xmlns:l="sap.ui.layout" xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:t="sap.ui.table" height="100%" controllerName="controller.MonitorNfce">
<Page title="Monitor NFC-e" showSubHeader="true" showFooter="true" showHeader="false">
<l:VerticalLayout width="100%">
<fb:FilterBar reset="onReset" search="onSearch" showRestoreButton="false" showClearButton="false">
<fb:filterItems>
<fb:FilterItem name="Caixa" label="Caixa" mandatory="false">
<fb:control>
<Select items="{InputHelpCaixas>/}" id="inputMonitorSelect">
<core:Item key="{InputHelpCaixas>id}" text="{InputHelpCaixas>id}"/>
</Select>
</fb:control>
</fb:FilterItem>
<!-- <fb:FilterItem name="CustomerInput" label="Cliente" labelTooltip="Escolher cliente para consulta" visible = "false">
						<fb:control>
							<Input id="inputMonitorCliente" placeholder="Selecionar Cliente" showValueHelp="true" valueHelpOnly="true" valueHelpRequest="onInputHelpClientes"></Input>
						</fb:control>
					</fb:FilterItem> -->
<fb:FilterItem name="PeriodoInicio" label="Data Inicial">
<fb:control>
<DatePicker id="monitorNfceDataInicial" placeholder="Data inicial" change="valData" valueFormat="yyyyMMdd" displayFormat="dd.MM.yyyy"/>
</fb:control>
</fb:FilterItem>
<fb:FilterItem name="PeriodoFim" label="Data Final">
<fb:control>
<DatePicker id="monitorNfceDataFinal" placeholder="Data final" change="valData" valueFormat="yyyyMMdd" displayFormat="dd.MM.yyyy"/>
</fb:control>
</fb:FilterItem>
<fb:FilterItem name="Centro" label="Centro" labelTooltip="Escolher centro para consulta">
<fb:control>
<Select id="inputHelpLocaisExpedicaoMonitor" items="{InputHelpLocaisExpedicao>/}">
<core:Item key="{InputHelpLocaisExpedicao>id}" text="{InputHelpLocaisExpedicao>id} - {InputHelpLocaisExpedicao>descricao} - {InputHelpLocaisExpedicao>cnpj}"/>
</Select>
</fb:control>
</fb:FilterItem>
<fb:FilterItem name="NFCe" label="NFCe">
<fb:control>
<Input maxLength="9" id="inputHelpNfce" type="Text"/>
</fb:control>
</fb:FilterItem>
<fb:FilterItem name="Código de status" label="Código de status">
<fb:control>
<Input maxLength="3" id="inputHelpCodigoStatus" type="Text"/>
</fb:control>
</fb:FilterItem>
<fb:FilterItem name="Exibir apenas erros" label="Exibir apenas erros">
<fb:control>
<CheckBox id="inputHelpApenasErros" text="" selected="false"/>
</fb:control>
</fb:FilterItem>
</fb:filterItems>
</fb:FilterBar>
</l:VerticalLayout>
<l:VerticalLayout width="100%" height="100%">
<l:content>
<ScrollContainer height="100%" width="100%" horizontal="true" vertical="true" focusable="true">
<t:Table id="tableMonitorNfce" rows="{MonitorNfce>/tVendasMonitornfce}" selectionMode="MultiToggle" visibleRowCount="Auto" visibleRowCountMode="sap.ui.table.VisibleRowCountMode.Auto" growing="true" growingThreshold="100" growingScrollToLoad="false">
<t:toolbar>
<Toolbar>
<content>
<Title id="title" text="Cupons"/>
<ToolbarSpacer/>
<Button icon="sap-icon://refresh" tooltip="Atualizar" press="onSearch"/>
<Button icon="sap-icon://locked" tooltip="Inutilizar" press="getInutilizar"/>
<Button icon="sap-icon://complete" tooltip="Sincronizar" press="getSincronizar"/>
<Button icon="sap-icon://print" tooltip="Imprimir Rede" press="onPrint"/>
<Button icon="sap-icon://action-settings" tooltip="Reenviar" press="getReenviar"/>
<Button icon="sap-icon://sys-cancel" tooltip="Cancelar" press="getCancelar"/>
<Button icon="sap-icon://journey-change" tooltip="Cancelar por Subs" press="getCancelarSubs"/>
<Button icon="sap-icon://receipt" tooltip="Imprimir Local" press="onPrintCupom"/>
<!-- <Button
										icon="sap-icon://decline"
										tooltip="Limpar"
										press="clearSelection"/> -->
</content>
</Toolbar>
</t:toolbar>
<t:columns>
<t:Column width="10em" flexible="false" resizable="false">
<Label text="CNPJ"/>
<t:template>
<Text text="{ path: 'MonitorNfce>cnpj', formatter: '.formatCnpj' }"/>
</t:template>
</t:Column>
<t:Column width="5em" flexible="false" resizable="false">
<Label text="Emissor"/>
<t:template>
<Text text="{MonitorNfce>emissor}" textAlign="Center"/>
</t:template>
</t:Column>
<t:Column width="6em" flexible="false" resizable="false">
<Label text="NFC-e"/>
<t:template>
<Text text="{MonitorNfce>nfnum}" textAlign="Center"/>
</t:template>
</t:Column>
<t:Column width="6em" flexible="false" resizable="false">
<Label text="Data"/>
<t:template>
<Text text="{MonitorNfce>datanfce}"/>
<!-- <Text text="{ path: 'MonitorNfce>DataPrevistaEntrega',
			   						  type: 'sap.ui.model.type.Date',
         							  formatOptions: {
          								 pattern: 'dd/MM/yyyy',
          								 UTC: true
        							  }}"/> -->
</t:template>
</t:Column>
<t:Column width="4em" flexible="false" resizable="false">
<Label text="Série"/>
<t:template>
<Text text="{MonitorNfce>serie}" textAlign="Center"/>
</t:template>
</t:Column>
<t:Column width="7em" flexible="false" resizable="false">
<Label text="Consumidor"/>
<t:template>
<Text text="{MonitorNfce>consumidor}"/>
</t:template>
</t:Column>
<t:Column width="4em" flexible="false" resizable="false">
<Label text="Código"/>
<t:template>
<Text text="{MonitorNfce>codigoStatus}"/>
</t:template>
</t:Column>
<t:Column width="18em" flexible="false" resizable="false">
<Label text="Descrição"/>
<t:template>
<Text text="{MonitorNfce>descricaoStatus}"/>
</t:template>
</t:Column>
<t:Column width="7em" flexible="false" resizable="false">
<Label text="Contingencia"/>
<t:template>
<core:Icon src="sap-icon://pending" visible="{=${MonitorNfce>contingencia}==='X'}"/>
</t:template>
</t:Column>
<t:Column width="7em" flexible="false" resizable="false">
<Label text="Caixa"/>
<t:template>
<Text text="{MonitorNfce>caixa}"/>
</t:template>
</t:Column>
<t:Column width="7em" flexible="false" resizable="false">
<Label text="Venda Cartão"/>
<t:template>
<core:Icon src="sap-icon://credit-card" visible="{=${MonitorNfce>vendaCartao}==='X'}"/>
</t:template>
</t:Column>
<t:Column width="24em" flexible="false" resizable="false">
<Label text="Chave Acesso"/>
<t:template>
<Text text="{MonitorNfce>chavenfce}"/>
</t:template>
</t:Column>
<t:Column width="8em" flexible="false" resizable="false">
<Label text="Código Canc"/>
<t:template>
<Text text="{MonitorNfce>codigoStatusCanc}"/>
</t:template>
</t:Column>
<t:Column width="22em" flexible="false" resizable="false">
<Label text="Descrição Cancelamento"/>
<t:template>
<Text text="{MonitorNfce>descricaoStatusCanc}"/>
</t:template>
</t:Column>
<t:Column width="8em" flexible="false" resizable="false">
<Label text="Código Canc Cartão"/>
<t:template>
<Text text="{MonitorNfce>codigoStatusCancCartao}"/>
</t:template>
</t:Column>
<t:Column width="22em" flexible="false" resizable="false">
<Label text="Descrição Cancelamento Cartão"/>
<t:template>
<Text text="{MonitorNfce>descricaoStatusCancCartao}"/>
</t:template>
</t:Column>
<t:Column width="4em" hAlign="Center" resizable="false">
<t:template>
<core:Icon src="sap-icon://sys-cancel" press="onProcessCancelamento"> </core:Icon>
</t:template>
</t:Column>
</t:columns>
</t:Table>
</ScrollContainer>
</l:content>
</l:VerticalLayout>
<footer>
<Toolbar>
<core:Fragment fragmentName="view.FooterStatus" type="XML"/>
<ToolbarSpacer/>
</Toolbar>
</footer>
</Page>
</mvc:View>
